apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: assignment-backend-rules
  namespace: monitoring
spec:
  groups:
    - name: assignment-backend.rules
      rules:
        - alert: BackendDown
          expr: up{namespace="app", job="assignment-backend"} == 0
          for: 2m
          labels:
            severity: critical
          annotations:
            summary: "Assignment backend is down (namespace: app)"
            description: "Prometheus has not been able to scrape the assignment backend for more than 2 minutes."

        - alert: BackendHighLatency
          expr: histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le)) > 1
          for: 2m
          labels:
            severity: page
          annotations:
            summary: "High latency on assignment backend (95th percentile > 1s)"
            description: "95th percentile HTTP request duration > 1s over last 5 minutes."
